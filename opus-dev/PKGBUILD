pkgname=opus-dev
pkgver=1.5.2
pkgrel=1
pkgdesc="Totally open, royalty-free, highly versatile audio codec"
arch=('x86_64')
url="https://github.com/xiph/opus"
license=('BSD')
source=("git+https://github.com/xiph/opus.git")
md5sums=('SKIP')

build() {
  cd $srcdir/opus
  ./autogen.sh
  NO_CONFLTO=1 ./configure \
    --host=${TARGET_ARCH} \
    --prefix=${MINGW_PREFIX} \
    --disable-shared \
    --disable-doc \
    --disable-extra-programs \
    --enable-dred \
    --enable-deep-plc \
    --enable-osce
  make
}

package() {
  cd $srcdir/opus
  make DESTDIR=$pkgdir install
  rm -rf $pkgdir${MINGW_PREFIX}/share
}